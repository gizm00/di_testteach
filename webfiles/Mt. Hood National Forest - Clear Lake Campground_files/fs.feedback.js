/***************************************
* @license
* ForeSee Client Code: Feedback
* http://www.answers.com/page/businesssolutions
* Built October 13, 16 14:47:04
* Version: 19.0.35
***************************************/
("undefined"!=typeof _acsDefine?_acsDefine:define)(["require","_acs","feedbackconfig",_acsNormalizeUrl("feedback/fs.utils.js"),_acsNormalizeUrl("feedback/fs.survey.js")],function(e,t,config,i,s){function n(e,t,s,n){if(u[e])return u[e].success.subscribe(t||function(){},!0,!0),void u[e].fail.subscribe(s||function(){},!0,!0);var o,r,a,c=!1;this.count=this.count?++this.count:1,o=this.count,r="load-css-"+o,a=document.createElement("link"),a.setAttribute("id",r),a.setAttribute("rel","stylesheet"),a.setAttribute("type","text/css");var h={link:a,url:e,didfail:!1,didsucceed:!1,success:new i.FSEvent,fail:new i.FSEvent};return h.success.subscribe(t,!0,!0),h.fail.subscribe(s,!0,!0),u[e]=h,"undefined"!=typeof a.addEventListener?"Android"==n.os.name&&n.os.version<4.4?setTimeout(function(){c=!0,h.didsucceed=!0,h.success.fire(a)},250):(a.addEventListener("load",function(){c=!0,h.didsucceed=!0,h.success.fire(a)},!1),a.addEventListener("error",function(){h.didfail=!0,h.fail.fire(a)},!1)):"undefined"!=typeof a.attachEvent&&a.attachEvent("onload",function(){var e,t,i=document.styleSheets.length;try{for(;i--;)if(t=document.styleSheets[i],t.id===r)return e=t.cssText,c=!0,h.didsucceed=!0,void h.success.fire(a)}catch(e){}c||(h.didfail=!0,h.fail.fire(a))}),document.getElementsByTagName("head")[0].appendChild(a),a.setAttribute("href",e),a}var o=window.location.href.toString().toLowerCase(),r={};if((o.indexOf("buildabear.c")>-1||o.indexOf("bab-dev-store.sparkred.")>-1)&&(r.FBALTPOSITION=!0),(o.indexOf(".peco.c")>-1||o.indexOf(".bge.com")>-1||o.indexOf(".comed.com")>-1)&&(r.FBALTOVERFLOW=!0),!(o.indexOf("argos.co")>-1&&window!==window.top)){t.home.indexOf("/serve/")>-1&&(r.FBALTSCROLL=!0);var a={remove:function(){this.parentNode&&this.parentNode.removeChild(this)},hasClass:function(e){return this.className.indexOf(e)>-1},addClass:function(e){this.hasClass(e)||(this.className+=" "+e)},removeClass:function(e){this.className=(this.className||"").replace(e,""),this.className=this.className.replace(/[ ]+$/g,"")},$:function(e){return this.querySelectorAll(e)},css:function(e){for(var t in e)e.hasOwnProperty(t)&&(this.style[t]=e[t])}},c=function(e){if("string"==typeof e&&e.indexOf("<")==-1)return document.querySelectorAll(e);if("string"==typeof e){var t=document.createElement("div");t.innerHTML=e,e=t.firstChild}for(var i in a)a.hasOwnProperty(i)&&(e[i]=a[i]);return e},h="Func",d="ion",p=function(e,t){var i;return(i=new window[h+"t"+d]("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"))(t||{})},l=function(e){function t(e){for(s=0;s<e.length;s++)if(i.testAgainstSearch(e[s],n))return!0;return!1}var s,n=window._acsURL||window.location.toString();return n=n.toLowerCase(),!e.whitelistActive||t(e.whitelistData)},u={},f=function(e,s,n,o,r,a){this.cfg=e,this.cpps=n;var c="acsFeedbackResultsCounter",h=window.location.pathname;this.uriPrefix=h.substr(0,h.indexOf("feedback")),this.gotbadge=!1,this.btncfg=e,this.badgeClicked=new i.FSEvent,this.surveyTriggered=new i.FSEvent,this.br=s,this.animationMove=4,this.btncfg.imgsrc=t.makeURI(this.uriPrefix+"feedback/templates/"+e.template+"/"+e.icon),e.counter?(this.isIcon=!1,this.counter=0,sessionStorage.getItem(c)&&(this.counter=Math.round(parseFloat(sessionStorage.getItem(c))),this.counter=isNaN(this.counter)?0:this.counter),this.btncfg.counter=this.counter,this.btncfg.counterLocale=e.counter.toLocaleString()):this.isIcon=!0,this.btncfg.btnClass="_acs _acs"+e.fbtype+"--"+e.template+" _acs"+e.fblocation,this.btnTemplate=o,this.emtemplate=r,this.enabled=!!a};f.prototype.setBtnTemplate=function(){var e={btncfg:this.btncfg},t=p(this.btnTemplate,e),s=this;s.badgeClicked.subscribe(function(){s.br.isMobile||v("feedback_clicked",{mid:s.cfg.mid}),s.surveyTriggered.fire({emtemplate:s.emtemplate})},!1,!0),this.$el=document.createElement("div"),this.$el.innerHTML=t,this.$el=c(this.$el.querySelectorAll("div._acs")[0]),this.enabled&&i.Bind(this.$el,"feedback:click",function(){s._unhover(),s.badgeClicked.fire(s.cfg)}),this.cfg.fbanimate&&(i.Bind(this.$el,"feedback:mouseenter",function(){s._hover()}),i.Bind(this.$el,"feedback:mouseleave",function(){s._unhover()})),document.body.appendChild(this.$el),r&&!r.FBALTPOSITION&&i.addClass(document.documentElement,"fsfb fsfb-relbody"),this.cfg.delay&&this.cfg.delay>0?setTimeout(i.proxy(function(){this.init()},this),this.cfg.delay):this.init()},f.prototype._hover=function(){this.cfg.fbanimate&&this.$el.addClass("_acsHover")},f.prototype._unhover=function(){this.cfg.fbanimate&&this.$el.removeClass("_acsHover")},f.prototype.init=function(e){var t=this.$el.$("._acsBadgeLabel"),s=this,n=s.cfg;if(e=e||function(){},this.$el.css({visibility:"hidden"}),t&&t.length>0){if(e){if(s._unhover(),this.isIcon)i.imgInfo("templates/"+n.template+"/"+n.icon,function(t){return function(i,n){setTimeout(function(){s._unhover(),setTimeout(function(){t.addClass("_acsAnimate"),e()},50),s._unhover()},50)}}(this.$el));else{s._unhover();var o=this.$el;setTimeout(function(){s._unhover(),setTimeout(function(){o.addClass("_acsAnimate"),e()},250)},250)}"vertical"==this.cfg.fbdirection&&(this.cfg.fblocation.indexOf("right")>-1?this.$el.addClass("_acsVertical_right"):this.$el.addClass("_acsVertical_left")),this.cfg.fbfixed&&this.$el.addClass("_acsFixed")}"none"===this.cfg.fbtype?this.$el.css({display:"none"}):this.$el.css({visibility:"visible"})}},f.prototype.setCounter=function(e){this.numTween&&(this.numTween.stop(),this.counter=this.numTween.val);var t=this.$el.$("._acsCounterInner")[0];this.numTween=new y(this.counter,e,i.proxy(function(e){t.innerHTML=Math.round(e).toLocaleString()},this)),this.numTween.go(1e3),sessionStorage.setItem("acsFeedbackResultsCounter",e)},f.prototype.disableCounter=function(){var e=this.$el.$("._acsBadgeImg")[0],i=this.cfg;e||(this.$el.$("._acsCounterInner")[0].innerHTML="",c(this.$el.$("._acsCounterInner")[0]).css({background:"none"}),e=c('<img style="position: relative;top: -2px;height: 19px;" src="'+t.makeURI("/feedback/templates/"+i.template+"/"+i.icon)+'" class="_acsBadgeImg">'),this.$el.$("._acsCounterInner")[0].appendChild(e))},f.prototype.enableCounter=function(){var e=this.$el.$("._acsBadgeImg")[0];e&&(this.$el.$("._acsCounterInner")[0].innerHTML="0",c(this.$el.$("._acsCounterInner")[0]).css({background:"#F87473"}))},f.prototype.remove=function(){this.enabled=!1,this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},f.prototype.dispose=function(){this.remove(),this.disposed=!0};var m={exposePublicAPI:function(e,t,s){var n,o,r={};r.CPPS=t,r.launchFeedback=r.launchACSFeedback=function(e){var r,a=!1,c=!1,h=config.instances;clearTimeout(n),clearTimeout(o),i._preventUnloadFor(500);for(var d=0;d<h.length;d++)if(h[d].mid==e){r=d,a=h[d];break}if(a&&a.disabled)return"This feedback has been disabled.";if(a.topics&&a.topics.length)for(var p=0;p<a.topics.length;p++)if(l(a.topics[p])){c=!0;break}if(!a)return"Error: MID provided is not valid";if(!c&&0!==a.topics.length)return"Error: Either this measure is disabled or there are no active topics";if((c||0===a.topics.length)&&!a.disabled){a.surveytype||"undefined"==typeof a.popup||(a.surveytype=a.popup?"popup":"modal"),a.template||(a.template="default");var u={},f=function(e,t,s,n){var o=window.location.pathname,r=o.substr(0,o.indexOf("feedback")),a=i.makeURI(r+"feedback/templates/"+e+"/"+t+".html"),c=new i.JSONP({success:i.proxy(function(e){n(e),s&&s.resolve()},this),failure:i.proxy(function(e){s&&s.error()},this)});c.get(a,"_templates_"+(e||"default")+"_")},m=new i.Async((!0),i.proxy(function(){var e=C.initialize(a,s,t,u.emTemplate,u.svContentsTemplate,u.epTemplate);e.show()},this),i.proxy(function(){},this));m.enqueue(function(e){f(a.template,"epilogue",e,function(e){u.epTemplate=e})}),m.enqueue(function(e){f(a.template,"surveycontents",e,function(e){u.svContentsTemplate=e})}),m.enqueue(function(e){f(a.template,"serviceunavailable",e,function(e){u.emTemplate=e})})}},r.pageReset=function(){clearTimeout(o),n&&(clearTimeout(n),n=null),n=setTimeout(function(){for(n=null;M.length>0;){var e=M.pop();e.badge&&e.badge.dispose()}i.Unbind("feedback:*"),FSFB&&i.pageNavEvent.unsubscribe(FSFB.pageReset),H.dispose(),C.disposePopups(),o=setTimeout(function(){P()},20)},200)},e.FSFB||(e.FSFB={}),i.ext(e.FSFB,r,!1)}},v=function(e,t,s,n){t=i.ext({pid:"qw0efhha4z",e:e},t||{}),t.code_version=config.code_version;var o=new i.ImageTransport;o.send({url:"https://www.dsply.com/index.php",success:s||function(){},failure:n||function(){},data:t})},b=function(){var e=c('<img src="'+t.makeURI("/feedback/loader.gif")+'" class="acs-loader">');this.$el=e};b.prototype.center=function(e){var t=this.$el.parentNode.offsetWidth,i=(this.$el.parentNode.offsetHeight,this.$el.offsetWidth);this.$el.offsetHeight;this.$el.css({left:(t-i)/2+"px",top:e?(t-i)/2+"px":"auto"})},b.prototype.remove=function(){this.$el.parentNode.removeChild(this.$el)};var y=function(e,t,i){this.from=e,this.to=t,this.diff=this.to-this.from,this.callback=i||function(){}};y.prototype={_tween:function(e){return--e*e*e+1},go:function(e){this.stop(),this.tm=e,this.startTime=new Date,this.timer=setInterval(i.proxy(function(){var e=new Date,t=e-this.startTime,i=Math.min(t/this.tm,1),s=this._tween(i);i>=1&&(clearInterval(this.timer),this.timer=null),this.val=s*this.diff+this.from,this.callback(this.val)},this),20)},stop:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}};var g=function(e,t){this.br=e,this.cfg=t};g.prototype.platformOK=function(){var e=this.cfg,t=this.br;return!(e.browser_cutoff[t.browser.name]&&t.browser.actualVersion<e.browser_cutoff[t.browser.name])&&!(e.platform_cutoff[t.os.name]&&t.os.version<e.platform_cutoff[t.os.name])};var w=function(e,t,i){this.template=i,this.br=e,this.cpps=t,this.emTemplate=null,this.css=null,this.typeTemplate=null,this.svContentsTemplate=null,this.epTemplate=null};w.prototype.getCss=function(e){n(t.makeURI("/feedback/templates/"+(this.template||"default")+"/fs.feedback.css"),function(t){t?e&&e.resolve():e&&e.error()},null,this.br)},w.prototype.getTemplate=function(e,s,n){var o=t.makeURI("/feedback/templates/"+(this.template||"default")+"/"+e+".html"),r="_templates_"+(this.template||"default")+"_",a=new i.JSONP({success:i.proxy(function(e){n&&n(e),s&&s.resolve()},this),failure:i.proxy(function(e){s&&s.error()},this)});a.get(o,r)},w.prototype.grabTemplates=function(e){this.queue=new i.Async((!0),i.proxy(function(){e&&e({typeTemplate:this.typeTemplate,emTemplate:this.emTemplate,epTemplate:this.epTemplate,svContentsTemplate:this.svContentsTemplate})},this),i.proxy(function(){},this)),this.queue.enqueue(i.proxy(function(e){this.getCss(e)},this)),this.queue.enqueue(i.proxy(function(e){this.getTemplate("badge",e,i.proxy(function(e){this.typeTemplate=e},this))},this)),this.queue.enqueue(i.proxy(function(e){this.getTemplate("serviceunavailable",e,i.proxy(function(e){this.emTemplate=e},this))},this)),this.queue.enqueue(i.proxy(function(e){this.getTemplate("epilogue",e,i.proxy(function(e){this.epTemplate=e},this))},this)),this.queue.enqueue(i.proxy(function(e){this.getTemplate("surveycontents",e,i.proxy(function(e){this.svContentsTemplate=e},this))},this))};var _=function(e,t,s){this.br=e,this.cpps=t,this.templateHolder={},this.loadSuccess=new i.FSEvent,this.loadFailure=new i.FSEvent;var n=new i.Async((!0),i.proxy(function(){this.loadSuccess.fire(this.templateHolder)},this),i.proxy(function(){this.loadFailure.fire()},this));n.enqueue(i.proxy(function(e){this.checkHealth(e)},this));for(var o=0;o<s.length;o++)n.enqueue(i.proxy(function(e){return function(t){var s=new w(this.br,this.cpps,e);s.grabTemplates(i.proxy(function(i){i?(this.templateHolder[e]=i,t.resolve()):t.error()},this))}}(s[o]),this))};_.prototype.checkHealth=function(e){setTimeout(i.proxy(function(){e.resolve()},this),1)};var k=function(e,s,n,o,r,a){this.sv=e,this.br=s,this.cpps=n,this.errTemplate=o,this.svTemplate=r,this.epTemplate=a,this.$domContent=[],this.$btns=[],this.fc=new i.FrameController("acsfeedback","feedback"),this.networkError=new i.FSEvent,this.SurveySubmitted=new i.FSEvent;for(var h=h||window,d=h.document.body.childNodes,l=0;l<d.length;l++)1===d[l].nodeType&&c(d[l]).hasClass("_acs")?this.$btns.push(d[l]):this.$domContent.push(d[l]);this.$el=c('<div class="acsMainContainerFullPage--'+this.sv.cfg.template+'"></div>'),this.sv.cfg.privacyuri=this.sv.cfg.privacyuri?this.sv.cfg.privacyuri:"http://www.foresee.com/about-us/privacy-policy/",this.sv.cfg.privacytext=this.sv.cfg.privacytext?this.sv.cfg.privacytext:"Privacy policy",this.sv.SubmitClicked.subscribe(i.proxy(function(){this.$content.removeClass("acsVisible"),this._showWait(),this._postSurveyData(i.proxy(function(){v("feedback_submitted",{mid:this.sv.cfg.mid}),this.$content.addClass("acsVisible"),this._showThankyou(),this._removeWait(),this.SurveySubmitted.fire()},this))},this)),this.networkError.subscribe(i.proxy(function(s){this._removeWait(),s&&s.type?v("survey_"+s.type,{mid:e.cfg.mid}):v("server_error",{mid:e.cfg.mid}),this.$content=c('<div class="acsMainContainerMobile--'+this.sv.cfg.template+'"></div>'),this.$el=c('<div class="acsMainContainerFullPage--'+this.sv.cfg.template+'"></div>'),this.$closebtn=c('<span><img src="'+t.makeURI("/feedback/templates/"+(this.sv.cfg.template||"default")+"/closeBtn"+(this.IE8?"IE8":"")+".png")+'" class="acsModalCloseButton"></span>'),this.$content.innerHTML=p(this.errTemplate,this.survey);var n=this.$content.$(".acs-serviceunavailable__message")[0];if("expired"===s.type){for(;n.firstChild;)n.removeChild(n.firstChild);this.sv.cfg.fbexpiremessage?n.appendChild(c("<p>"+this.sv.cfg.fbexpiremessage+"</p>")):n.appendChild(c("<p>This is an expired survey!</p>"))}else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(c("<p>Feedback isn't available right now.</p><p>Please check back later.</p>"))}i.Bind(this.$closebtn,"feedback:click",i.proxy(function(){this.hide(!0)},this)),this.$el.appendChild(this.$closebtn),this.$el.appendChild(this.$content);var o=this.$el.$(".acs-close-button")[0];i.Bind(o,"feedback:click",i.proxy(function(){this.hide(!0)},this)),this.$content.addClass("acsVisible"),window.document.body.innerHTML="",window.document.body.appendChild(this.$el)},this)),this._getSurveyData(i.proxy(function(e){this.survey=e,this.show()},this))};k.prototype._renderSurvey=function(){var e=e||window,s=this.sv.cfg,n=this,o=e.document.body;if(!this.sv.cfg.preview){var r=function(e){27==e.keyCode&&(v("feedback_abandoned",{mid:s.mid}),n.hide(!1)),i.Unbind(document.body,"feedback:keyup",r)};i.Bind(document.body,"feedback:keyup",r)}o.innerHTML="",0===this.$el.children.length&&(this.$closebtn=c('<span><img src="'+t.makeURI("/feedback/templates/"+(this.sv.cfg.template||"default")+"/closeBtn"+(this.IE8?"IE8":"")+".png")+'" class="acsModalCloseButton"></span>'),this.$content=c('<div class="acsMainContainerMobile--'+this.sv.cfg.template+'"></div>'),this.$el.appendChild(this.$closebtn),this.$el.appendChild(this.$content)),o.appendChild(this.$el),this.sv.cfg.preview||i.Bind(this.$closebtn,"feedback:click",i.proxy(function(){v("feedback_abandoned",{mid:s.mid}),this.hide(!1)},this)),v("survey_shown",{mid:this.sv.cfg.mid}),this._showWait()},k.prototype._showWait=function(){this._removeWait(),this._wait=new b,this.$el.appendChild(this._wait.$el),this._wait.center();var e=i.getScroll(window),t=i.getSize(window);this._wait.$el.css({position:"absolute",top:e.y+(t.h-this._wait.$el.offsetHeight)/2+"px",left:e.x+(t.w-this._wait.$el.offsetWidth)/2+"px"})},k.prototype._removeWait=function(){this._wait&&(this._wait.remove(),this._wait=null)},k.prototype.hide=function(e){window.document.body.innerHTML="";for(var t=0;t<this.$domContent.length;t++)window.document.body.appendChild(this.$domContent[t]);e||this._showBtns()},k.prototype._showBtns=function(){for(var e=0;e<this.$btns.length;e++)window.document.body.appendChild(this.$btns[e])},k.prototype.show=function(){if(this._renderSurvey(),this._removeWait(),this.survey.ansLogoSrc=t.makeURI("/feedback/p_b_answers.png"),0===this.$content.children.length){var e=p(this.svTemplate,this.survey);this.$content.innerHTML=e,this.sv.bind(this.$content)}this.$content.addClass("acsVisible"),this.sv.SurveyUIUpdated.fire()},k.prototype._showThankyou=function(){this._removeWait();var e=p(this.epTemplate,this.survey);this.$closebtn=c('<span><img src="'+t.makeURI("/feedback/templates/"+(this.sv.cfg.template||"default")+"/closeBtn"+(this.IE8?"IE8":"")+".png")+'" class="acsModalCloseButton"></span>'),this.sv.cfg.preview||i.Bind(this.$closebtn,"feedback:click",i.proxy(function(){this.hide(!0)},this),!0),this.$content.innerHTML=e,this.$el.removeChild(this.$el.childNodes[0]),this.$el.removeChild(this.$el.childNodes[0]),this.$el.appendChild(this.$closebtn),this.$el.appendChild(this.$content);for(var s=this.$el.$(".acs-close-button")[0],n=this.$el.$("h1"),o=0;o<n.length;o++)c(n[o]).addClass("acs-feedback__heading acs-feedback__heading--h1");this.sv.cfg.preview||i.Bind(s,"feedback:click",i.proxy(function(){this.hide(!0)},this))},k.prototype._getSurveyData=function(){this.sv.isExpired()?this.networkError.fire({type:"expired"}):this.fc.ready.subscribe(i.proxy(function(){var e={mid:this.sv.cfg.mid,cachebust:(new Date).getTime()};this.sv.cfg.version&&(e.version=this.sv.cfg.version),this._surveyTimer=setTimeout(i.proxy(function(){this.networkError.fire({type:"timedout"})},this),1e4),this.fc.ajax("GET",this.sv.cfg.datauri,e,i.proxy(function(e,t){this.networkError.didFire||(e?(clearTimeout(this._surveyTimer),this.sv.SurveyData.fire(t,i.proxy(function(e){this.survey=e,this.show()},this))):this.networkError.fire({type:"getdata_failed"}))},this))},this),!0,!0)},k.prototype._postSurveyData=function(e){return this.sv.cfg.preview?void setTimeout(function(){e&&e()},100):(this._surveyTimer=setTimeout(i.proxy(function(){this.networkError.fire({type:"timedout"})},this),1e4),void(this.fc&&this.fc.ajax("POST",this.sv.cfg.posturi,this.sv._serialize(),i.proxy(function(t,i){t?(clearTimeout(this._surveyTimer),e&&e()):(clearTimeout(this._surveyTimer),sessionStorage.setItem("acsFeedbackSubmitted","true"),this.networkError.fire({type:"postdata_failed"}))},this),!0,"application/json")))};var $=function(e,t,s,n,o,r){this.cfg=e,this.br=t,this.cpps=s,this.errortemplate=n,this.modaltemplate=o,this.eptemplate=r,this.init(),this.SurveySubmitted=new i.FSEvent,this.NetworkError=new i.FSEvent};$.prototype.init=function(){var e=this,t=i.getSize(window);switch("fullpage"!==this.cfg.surveytype&&(this.br.isMobile||t.w<=500)&&(this.cfg.surveytype="popup"),this.cfg.surveytype){case"popup":this.chrome=new x(new s.SurveyBuilder(this.cfg,this.cpps,this.br),this.cfg,this.br),this.chrome.SurveySubmitted.subscribe(function(){e.SurveySubmitted.fire()}),this.chrome.show();break;case"modal":i.isDefined(this.chrome)?this.chrome.show():(this.survey=new s.SurveyBuilder(this.cfg,this.cpps,this.br),this.chrome=new R(this.survey,this.br,this.cfg,this.errortemplate,this.modaltemplate,this.eptemplate),this.chrome.SurveySubmitted.subscribe(function(){e.SurveySubmitted.fire()}),this.chrome.networkError.subscribe(function(){e.NetworkError.fire()}));break;case"fullpage":i.isDefined(this.chrome)?this.chrome.show():(this.survey=new s.SurveyBuilder(this.cfg,this.cpps,this.br),this.chrome=new k(this.survey,this.br,this.cfg,this.errortemplate,this.modaltemplate,this.eptemplate),this.chrome.SurveySubmitted.subscribe(function(){e.SurveySubmitted.fire()}),this.chrome.networkError.subscribe(function(){e.NetworkError.fire()}))}},$.prototype.show=function(){this.chrome.show()},$.prototype.hide=function(){this.chrome&&this.chrome.hide()};var C={};C.popups=[],C.getPopup=function(e){var t=i.getSize(window);if(t.w<=500)return!1;var s=C.popups;if(s.length>0){for(var n=0;n<s.length;n++)if(s[n].cfg.mid==e)return s[n];return!1}return!1},C.disposePopups=function(){C.popups=[]},C.removePopup=function(e){for(var t=C.popups,i=[],s=0;s<t.length;s++)t[s].cfg.mid!==e&&i.push(t);C.popups=i},C.initialize=function(e,t,i,s,n,o){e.surveytype||"undefined"==typeof e.popup||(e.surveytype=e.popup?"popup":"modal");var r=C.getPopup(e.mid);return r&&!r.cfg.popup?r.show():(r=new $(e,t,i,s,n,o),C.popups.push(r),r.SurveySubmitted.subscribe(function(e){return function(){C.SurveySubmitted.fire(e)}}(e)),r.NetworkError.subscribe(function(){C.removePopup(e.mid),C.NetworkError.fire()})),r},C.SurveySubmitted=new i.FSEvent,C.NetworkError=new i.FSEvent;var T=function(e){this.br=e,this.mid=i.getHashParm("mid"),this.previewmode=i.getHashParm("previewmode").toLowerCase(),this.datauri=i.getHashParm("datauri"),this.template=i.getHashParm("template")||"default",this.surveytype=i.getHashParm("surveytype")?i.getHashParm("surveytype"):"modal",this.tempHolder={}};T.prototype.show=function(){if(this.mid&&this.previewmode&&this.datauri){var e=new _(this.br,{},[this.template]);e.loadSuccess.subscribe(i.proxy(function(e){this.tempHolder=e[this.template];C.initialize({mid:this.mid,datauri:this.datauri,posturi:"",reporturi:"",surveytype:this.surveytype,autowhitelist:!0,preview:!0,template:this.template,replay:!1},this.br,null,this.tempHolder.emTemplate,this.tempHolder.svContentsTemplate,this.tempHolder.epTemplate)},this)),e.loadFailure.subscribe(i.proxy(function(){},this))}else alert("You need mid, previewmode, and datauri.")};var S=function(e,t,i){this.cfg=e,this.br=t,this.cpps=i,this.cfg.template="undefined"!=typeof this.cfg.template?this.cfg.template:"default",this.cfg.surveytype="undefined"!=typeof this.cfg.surveytype?this.cfg.surveytype:"modal",this.cfg.fbcolor="undefined"!=typeof this.cfg.fbcolor?this.cfg.fbcolor:"#F24554",this.cfg.replay="undefined"!=typeof this.cfg.replay&&this.cfg.replay};S.prototype.renderBadge=function(){var e=new _(this.br,this.cpps,[this.cfg.template]);e.loadSuccess.subscribe(i.proxy(function(e){var t=e[this.cfg.template];this.cfg.badge=new f(this.cfg,this.br,this.cpps,t.typeTemplate,t.emTemplate,(!1)),this.cfg.badge.setBtnTemplate()},this)),e.loadFailure.subscribe(i.proxy(function(){}))};var x=function(e,t,s){this.height=600,this.width=400,this.survey=e,this.cfg=t,this.cpps=e.cpps,this.SurveySubmitted=new i.FSEvent,this.br=s,this.networkError=i.FSEvent()};x.prototype._getCXRParams=function(){var e="";return this.cfg.replay===!0&&"undefined"!=typeof E&&E.recorder&&(e+="cxrid="+encodeURIComponent(E.recorder.getGlobalId())+"&cxrurl="+encodeURIComponent(F.rec_transport_url)),e},x.prototype.show=function(){if(!this.winRef){var e=this.cfg.preview?null:JSON.stringify(this.cpps.all()),s=this._getCXRParams(),n=this,o=this.cfg.preview?t.makeURI("/feedback/fs.feedbacksurvey.html?mid="+encodeURIComponent(this.survey.cfg.mid)+"&t="+encodeURIComponent(this.cfg.template||"default")+"&datauri="+i.getParam("datauri")+"&ns="+encodeURIComponent("preview")):t.makeURI("/feedback/fs.feedbacksurvey.html?mid="+encodeURIComponent(this.survey.cfg.mid)+"&t="+encodeURIComponent(this.cfg.template||"default")+"&acsUrl="+encodeURIComponent(window.location.href)+"&cpps="+encodeURIComponent(e)+"&ns="+encodeURIComponent(this.cpps.site_id())+"&"+s);this.br.isIE&&this.br.browser.actualVersion<=11&&("//"==o.substr(0,2)&&(o="https:"+o),"http"==o.substr(0,4)&&o.replace("http","https")),this.cfg.preview&&window!==window.top?window.location.href=window.location.href.indexOf("localhost:8080")>-1?o:"/preview"+o:(this.winRef=window.open(o,"_system"),this._checker=setInterval(function(){try{var e=n.winRef.location+"";e.indexOf("acsSurveyComplete")>-1&&(clearInterval(n._checker),n.SurveySubmitted.fire())}catch(e){clearInterval(n._checker),n.SurveySubmitted.fire()}},500))}};var E=null,I=null,F=null,B=i.now(),H={setup:function(s,n,o,r){e([t.makeURI("cxreplay/fs.record.js"),"recordconfig"],function(e,t){F=t,n.set("cxreplayaws","true"),I||(I=i.getGlobalStore()),E=e.getInstance(s,window,I),r(E)})},startProcessing:function(e,t,s){H.startTransmitting(e,t,s,function(e){e&&e.recorder&&e.recorder.processImmediately(Math.max(2e4-(i.now()-B),0))})},dispose:function(){E&&(E.dispose(),E=null)},startTransmitting:function(e,t,s,n){B=i.now(),s.replay===!0&&(E?(E.beginTransmitting(),n&&n(E)):H.setup(e,t,s,function(e){e.setTransmitOK(),n&&n(e)}))}};config=i.ext({browser_cutoff:{IE:8,IEMobile:8,Safari:4,Firefox:11,Chrome:20,Opera:1e3},platform_cutoff:{Android:4,Winphone:7.4,iPod:7,iPhone:7,iPad:7}},config);var M=[],P=function(){var e,n=!!i.getHashParm("previewmode"),o=!!i.getHashParm("previewbadgemode"),r=config.instances,a=[],c=!1;new i.FSEvent;if(r||n||o){var h=new i.Browser;h.browserReady.subscribe(function(){if(n){var d=new T(h);return void d.show()}if("IE"==h.browser.name&&h.browser.version<9)for(var p=0;p<r.length;p++)"vertical"==r[p].fbdirection&&(r[p].fbdirection="horizontal");var l=new g(h,config),u=new i.CPPS(null,"feedback");if(u.set("code_version",config.code_version),u.set("env",t.isProduction?"prd":"stg"),o){var v=JSON.parse(decodeURIComponent(i.getParam("cfg")));return void(v.mid&&(e=new S(v,h,u),e.renderBadge()))}if(l.platformOK()){m.exposePublicAPI(window,u,h),FSFB&&i.pageNavEvent.subscribe(FSFB.pageReset,!1,!1);for(var b=0;b<r.length;b++){var y=r[b],w=!1;if(y.topics&&y.topics.length)for(var k=0;k<y.topics.length;k++)if(s.TopicTester(y.topics[k])){w=!0;break}if(y.replay===!0&&y.disabled===!1&&(c=!0),(w||y.topics&&0===y.topics.length)&&!y.disabled&&window==window.top){var $=!1;y.template||(y.template="default");for(var x=0;x<a.length;x++)a[x]===y.template&&($=!0);$||a.push(y.template),M.push(y)}}if(M.length>0){var E=a.length>0?a:["default"],F=new _(h,u,E);F.loadSuccess.subscribe(i.proxy(function(e){for(var t=0;t<M.length;t++)if("badge"===M[t].fbtype){var i=e[M[t].template];M[t].badge=new f(M[t],h,u,i.typeTemplate,i.emTemplate,(!0)),M[t].badge.setBtnTemplate(),M[t].badge.surveyTriggered.subscribe(function(e){return function(){e.replay===!0&&H.startTransmitting(h,u,e),C.initialize(e,h,u,i.emTemplate,i.svContentsTemplate,i.epTemplate)}}(M[t]),!1,!1)}C.SurveySubmitted.subscribe(function(e){var t,i;if(e&&e.mid)for(H.startProcessing(h,u,e),t=0;t<M.length;t++)M[t].badge&&M[t].mid===e.mid&&M[t].badge.remove();else for(i=0;i<M.length;i++)M[i].badge&&M[i].badge.remove()})},this),!0,!0)}c&&H&&H.setup(h,u,M[0],function(e){for(var t=0;t<M.length;t++)M[t].stg=I,M[t].record=e})}},!0,!0)}};t.domReady(P);var R=function(e,t,s,n,o,r){this.sv=e,this.cfg=e.cfg,this.instcfg=s,this.browser=t,this.em=n,this.noserv=n,this.eptemplate=r,this.IE8=t.isIE&&t.browser.version<9,this.add(),this.modaltemplate=o,this.fc=new i.FrameController("acsfeedback","feedback"),this.sv.cfg.privacyuri=this.sv.cfg.privacyuri?this.sv.cfg.privacyuri:"http://www.foresee.com/about-us/privacy-policy/",this.sv.cfg.privacytext=this.sv.cfg.privacytext?this.sv.cfg.privacytext:"Privacy policy",this.SurveySubmitted=new i.FSEvent,this.networkError=new i.FSEvent;this.sv.SubmitClicked.subscribe(i.proxy(function(){this.$content.removeClass("acsVisible"),this._showWait(),this._postSurveyData(i.proxy(function(){v("feedback_submitted",{mid:e.cfg.mid}),this.$content.addClass("acsVisible"),this._showThankyou(),this.SurveySubmitted.fire(),this._removeWait()},this))},this)),this.networkError.subscribe(i.proxy(function(t){this._removeWait(),t&&t.type?v("survey_"+t.type,{mid:e.cfg.mid}):v("server_error",{mid:e.cfg.mid}),this.$content.innerHTML=p(this.noserv,this.survey);var s=this.$content.$("h1"),n=this.$content.$(".acs-close-button")[0],o=this.$content.$(".acs-serviceunavailable__message")[0];if("expired"===t.type){for(;o.firstChild;)o.removeChild(o.firstChild);if(this.sv.cfg.fbexpiremessage)o.appendChild(c("<p>"+this.sv.cfg.fbexpiremessage+"</p>"));else{var r=this._unencodeHTML(this.sv.defaultCfg.expired);o.appendChild(c(r))}}else{for(;o.firstChild;)o.removeChild(o.firstChild);var a=this._unencodeHTML(this.sv.defaultCfg.unavailable);o.appendChild(c(a))}for(var h=0;h<s.length;h++)c(s[h]).addClass("acs-feedback__heading acs-feedback__heading--h1");this.cfg.preview||(this.positionModal(),i.Bind(n,"feedback:click",i.proxy(function(){this.remove()},this))),this.$content.addClass("acsVisible")},this)),this._getSurveyData()};R.prototype._showThankyou=function(){var e=p(this.eptemplate,this.survey);this.$content.innerHTML=e;for(var t=this.$content.$("h1"),s=this.$content.$(".acs-close-button")[0],n=0;n<t.length;n++)c(t[n]).addClass("acs-feedback__heading acs-feedback__heading--h1");this.positionModal(),this.cfg.preview||i.Bind(s,"feedback:click",i.proxy(function(){this.remove()},this))},R.prototype._unencodeHTML=function(e){var t=/&lt;/gi,i=/&gt;/gi;return e.replace(t,"<").replace(i,">")},R.prototype._showWait=function(){this._removeWait(),this._wait=new b,this.$el.appendChild(this._wait.$el),this._wait.center();var e=i.getScroll(window),t=i.getSize(window);this._wait.$el.css({top:e.y+(t.h-this._wait.$el.offsetHeight)/2+"px"})},R.prototype._removeWait=function(){this._wait&&(this._wait.remove(),this._wait=null)},R.prototype.remove=function(){this.$el.remove()},R.prototype.add=function(e){e=e||window;var s=e.document.body,n=e.document.documentElement,o=Math.max(s.scrollHeight,s.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight),r="acsModalContainer--"+this.instcfg.template,a=this.sv.cfg,h=c('<div class="acsModalBackFace"></div>'),d=c('<div class="acsModalChrome"></div>');if(this.$el=c('<div class="'+r+'"></div>'),this.$el.css({height:o}),this.browser.isIE&&8==this.browser.browser.version&&h.addClass("acsIE8"),!this.cfg.preview){var p=this;i.Bind(h,"feedback:click",i.proxy(function(e){(this.survey||this.networkError.didFire)&&(v("feedback_abandoned",{mid:a.mid}),this.survey?this.hide():this.remove())},this));var l=function(e){27==e.keyCode&&(v("feedback_abandoned",{mid:a.mid}),p.hide()),i.Unbind(document.body,"feedback:keyup",l)};i.Bind(document.body,"feedback:keyup",l),i.Bind(d,"feedback:click",function(e){var t=e.target;t&&t==d&&(v("feedback_abandoned",{mid:a.mid}),p.hide())})}var u=this.head=c('<div class="acsModalContent"></div>'),f=c('<div class="acsModalHead"></div>'),m=c('<img src="'+t.makeURI("/feedback/templates/"+(this.instcfg.template||"default")+"/closeBtn"+(this.IE8?"IE8":"")+".png")+'" class="acsModalCloseButton">');this.$head=f,f.appendChild(m),u.appendChild(f),this.$content=c('<div class="acsModalInnerContent"></div>'),u.appendChild(this.$content),d.appendChild(u),this.$el.appendChild(h),this.$el.appendChild(d);var b=e.document.body;b.appendChild(this.$el),this.cfg.preview||i.Bind(m,"feedback:click",i.proxy(function(e){v("feedback_abandoned",{mid:a.mid}),this.hide()},this)),setTimeout(function(){h.addClass("_acsActive")},20),this._showWait()},R.prototype.renderSurvey=function(){v("survey_shown",{mid:this.sv.cfg.mid}),this._removeWait(),this.$head.addClass("acsVisible"),this.survey.ansLogoSrc=t.makeURI("/feedback/p_b_answers.png");var e=p(this.modaltemplate,this.survey);this.$content.innerHTML=e,this.sv.bind(this.$content),this.positionModal(),this.$content.addClass("acsVisible")},R.prototype.positionModal=function(){var e=i.getScroll(window),t=i.getSize(window),s=this.$content.offsetHeight||this.prevOffsetHeight,n=Math.max(0,e.y+(t.h-s-50)/2)+"px";r&&r.FBALTSCROLL?this.head.style.top=n:this.head.style.marginTop=n,r&&r.FBALTOVERFLOW&&this.$el.css({"overflow-y":"scroll",display:"block"})},R.prototype.hide=function(){this.prevOffsetHeight=this.$content.offsetHeight,this.$el.css({display:"none"})},R.prototype.show=function(){this.positionModal(),this.$el.css({display:"block"})},R.prototype._getSurveyData=function(){this.sv.isExpired()?this.networkError.fire({type:"expired"}):this.fc.ready.subscribe(i.proxy(function(){var e={mid:this.sv.cfg.mid,cachebust:(new Date).getTime()};this.sv.cfg.version&&(e.version=this.sv.cfg.version),this._surveyTimer=setTimeout(i.proxy(function(){this.networkError.fire({type:"timedout"})},this),1e4),this.fc.ajax("GET",this.sv.cfg.datauri,e,i.proxy(function(e,t){this.networkError.didFire||(e?(clearTimeout(this._surveyTimer),
this.sv.SurveyData.fire(t,i.proxy(function(e){this.survey=e,this.renderSurvey()},this))):this.networkError.fire({type:"getdata_failed"}))},this))},this),!0,!0)},R.prototype._postSurveyData=function(e){return this.cfg.preview?void setTimeout(function(){e&&e()},100):(this._surveyTimer=setTimeout(i.proxy(function(){this.networkError.fire({type:"timedout"})},this),1e4),void(this.fc&&this.fc.ajax("POST",this.cfg.posturi,this.sv._serialize(),i.proxy(function(t,i){t?(clearTimeout(this._surveyTimer),e&&e()):(clearTimeout(this._surveyTimer),sessionStorage.setItem("acsFeedbackSubmitted","true"),this.networkError.fire({type:"postdata_failed"}))},this),!0,"application/json")))}}});